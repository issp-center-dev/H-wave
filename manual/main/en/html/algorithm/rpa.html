
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>5.2. Random Phase Approximation &#8212; H-wave Users Guide 0.3-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Acknowledgments" href="../acknowledgement.html" />
    <link rel="prev" title="5.1. Unrestricted Hartree-Fock method" href="uhf.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="random-phase-approximation">
<span id="algorithm-sec"></span><h1><span class="section-number">5.2. </span>Random Phase Approximation<a class="headerlink" href="#random-phase-approximation" title="Permalink to this heading">¶</a></h1>
<p>The random phase approximation (RPA) is a method to detect the response to the fluctuations of
one-body operators by the effect of electron correlations, starting from the non-interacting
state.
While in the UHF approximation an initial guess of the configuration is required,
the RPA method enables to infer the ordered phase that emerges from the second-order transition.
H-wave implements RPA method using Matsubara frequency, and allows to compare with the dynamical
observables measured in the experiments by analytical continuation.</p>
<p>In the following, the algorithm is described.
In the RPA mode of H-wave, the Hamiltonian given below will be considered:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-0">
<span class="eqno">(5.11)<a class="headerlink" href="#equation-algorithm-rpa-0" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
 {\cal H}&amp;={\cal H}_0+{\cal H}_{\rm int},\\
 {\cal H}_0&amp;=\sum_{\langle i\alpha;j\beta \rangle}
  (t_{ij}^{\alpha \beta}c_{i\alpha}^{\dagger}
  c_{j\beta}^{\mathstrut}+\mbox{H.c.}),\\
 {\cal H}_{\rm int}&amp;=\sum_{ij}\sum_{\alpha, \alpha', \beta, \beta'}W_{ij}^{\beta\beta',\alpha\alpha'}\left(
  c_{i\alpha}^{\dagger}c_{i\alpha'}c_{j\beta'}^{\dagger}c_{j\beta}+\mbox{H.c.}\right)
\end{aligned}\end{split}\]</div>
<p>Applying the Fourier transformation</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-1">
<span class="eqno">(5.12)<a class="headerlink" href="#equation-algorithm-rpa-1" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
c_{i\alpha}
=\frac{1}{\sqrt{N_L}}\sum_{\bf{k}}
e^{i \bf{k}\cdot \bf{r}_{i}}c_{\bf{k},\alpha}^{\mathstrut},
\end{aligned}\]</div>
<p>the Hamiltonian is rewritten in the following form</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-2">
<span class="eqno">(5.13)<a class="headerlink" href="#equation-algorithm-rpa-2" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
 {\cal H}&amp;=\sum_{{\bf k}\alpha\beta}
 (\varepsilon_{\alpha\beta}({\bf k})c_{{\bf k}\alpha}^{\dagger}
 c_{{\bf k}\beta}^{\mathstrut}+\mbox{H.c.}) \nonumber\\
&amp;+\frac{1}{2N_L}\sum_{{\bf k} {\bf k}'{\bf q}}\sum_{\alpha\beta\alpha'\beta'}
 W^{\beta\beta',\alpha\alpha'}_{{\bf q}}
 c_{{\bf k}+{\bf q},\alpha}^{\dagger}
  c_{{\bf k},\alpha'}^{\mathstrut}
  c_{{\bf k}'-{\bf q},\beta'}^{\dagger}
  c_{{\bf k}',\beta}^{\mathstrut}
\end{aligned}\end{split}\]</div>
<p>In the random phase approximation, the density fluctuation by the effect of electron correlation
is detected with respect to <span class="math notranslate nohighlight">\({\cal H}_0\)</span>.
The scattering by the interaction must therefore be considered on the basis
where <span class="math notranslate nohighlight">\({\cal H}_0\)</span> is diagonalize, and thus the interaction term is approximated as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-3">
<span class="eqno">(5.14)<a class="headerlink" href="#equation-algorithm-rpa-3" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
&amp;W^{\beta\beta',\alpha\alpha'}_{\bf{q}}c_{\bf{k}+\bf{q},\alpha}^{\dagger}c_{\bf{k},\alpha'}^{\mathstrut}
c_{\bf{k}'-\bf{q},\beta'}^{\dagger} c_{\bf{k}',\beta}^{\mathstrut}\nonumber\\
&amp;\sim W^{\beta\beta',\alpha\alpha'}_{\bf{q}} \sum_{\gamma, \gamma'}
u_{\alpha \gamma, \bf{k}+\bf{q}}^* d_{\bf{k}+\bf{q},\gamma}^{\dagger}
u_{\alpha' \gamma, \bf{k}} d_{\bf{k},\gamma}^{\mathstrut}
u_{\beta' \gamma', \bf{k}'-\bf{q}}^* d_{\bf{k}'-\bf{q},\gamma'}^{\dagger}
u_{\beta  \gamma', \bf{k}'}d_{\bf{k}',\gamma'}^{\mathstrut}.
\end{aligned}\end{split}\]</div>
<p>Here,</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-4">
<span class="eqno">(5.15)<a class="headerlink" href="#equation-algorithm-rpa-4" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
c_{\bf{k},\alpha} = \sum_{\gamma} u_{\alpha \gamma, \bf{k}} d_{\bf{k}, \gamma}
\end{aligned}\]</div>
<p>and <span class="math notranslate nohighlight">\(d_{\bf{k}, \gamma}\)</span> denotes the annihilation operator that diagonalizes <span class="math notranslate nohighlight">\({\cal H}_0\)</span>. (<span class="math notranslate nohighlight">\(\gamma\)</span> refers to the index of the eigenvalue.)
Then, the irreducible one-body Green’s function is written as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-5">
<span class="eqno">(5.16)<a class="headerlink" href="#equation-algorithm-rpa-5" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
 G^{(0)\alpha\beta}_{\gamma}({\bf k}, i\omega_{n})=
  \frac{u^{\alpha\gamma}({\bf k})u^{*\beta\gamma}({\bf k})}{i\epsilon_{n}-\xi^{\gamma}({\bf k})+\mu}.
\end{aligned}\]</div>
<p>The irreducible susceptibility is given in the following form, as it must be closed
within the diagnoalized elements:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-6">
<span class="eqno">(5.17)<a class="headerlink" href="#equation-algorithm-rpa-6" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
 X^{(0)\alpha\alpha', \beta\beta'}({\bf q},i\omega_n)=
  -\frac{T}{N_L}
  \sum_{\gamma=1}^{n_{\rm orb}}\sum_{{\bf k},n}
  G^{(0)\alpha\beta}_{\gamma}({\bf k}+{\bf q}, i\omega_m+ i\epsilon_{n})
  G^{(0)\beta'\alpha'}_{\gamma}({\bf k}, i\epsilon_{n}),
\end{aligned}\]</div>
<p>By using the irreducible susceptibility, the susceptibility matrix from the RPA
is obtained as follows:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-7">
<span class="eqno">(5.18)<a class="headerlink" href="#equation-algorithm-rpa-7" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
X^{\alpha\alpha', \beta\beta'}(q)&amp;=
X^{(0)\alpha\alpha', \beta\beta'}(q) - \sum_{\alpha_1'\beta_1'}
X^{(0)\alpha\alpha', \beta_1\beta_1'}(q) W^{\beta_1\beta_1', \alpha_1\alpha_1'}_{\bf q}X^{\alpha_1 \alpha_1' , \beta \beta'}(q),
\end{aligned}\]</div>
<p>Combining indices such as <span class="math notranslate nohighlight">\(\alpha\alpha^\prime\)</span> into one index, they are expressed
in the matrix form. Then finally it leads to the expression:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-8">
<span class="eqno">(5.19)<a class="headerlink" href="#equation-algorithm-rpa-8" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
 \hat{X}(q)&amp;=\hat{X}^{(0)}(q)-\hat{X}^{(0)}(q)\hat{W}(q)\hat{X}(q)\nonumber\\
 &amp;=\left[\hat{I}+\hat{X}^{(0)}(q)\hat{W}(q)\right]^{-1}\hat{X}^{(0)}(q).
\end{aligned}\end{split}\]</div>
<p>In the above formula, orbitals and spins were treated as unified generalised orbitals.
Of the arrays needed to perform the calculations,
the susceptibility ( <span class="math notranslate nohighlight">\(X^{(0)\alpha\alpha^\prime, \beta\beta^\prime}({\bf q},i\omega_n)\)</span>, <span class="math notranslate nohighlight">\(X^{\alpha\alpha^\prime, \beta\beta^\prime}({\bf q},i\omega_n)\)</span>) is the largest multidimensional array,
given by <span class="math notranslate nohighlight">\(N_{\rm orb}^4 N_{\rm spin}^4 N_k N_{\omega}\)</span>, where the memory cost and computational complexity increase as the size increases.
As explained below, the size of the multidimensional array of susceptibilities can be reduced by separating orbits and spins:
for the two-body interactions handled in H-wave’s RPA mode, separating orbits and spins results in</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-9">
<span class="eqno">(5.20)<a class="headerlink" href="#equation-algorithm-rpa-9" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
&amp; W^{\beta\sigma_1\sigma_1',\alpha\sigma\sigma'}_{\bf{q}}c_{\bf{k}+\bf{q},\alpha \sigma}^{\dagger}c_{\bf{k},\alpha \sigma'}^{\mathstrut}
c_{\bf{k}'-\bf{q},\beta\sigma_1'}^{\dagger} c_{\bf{k}',\beta\sigma_1}^{\mathstrut}.
\end{aligned}\]</div>
<p>Since the scattering is on the same diagonalized general orbital,
the irreducible susceptibility becomes</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-10">
<span class="eqno">(5.21)<a class="headerlink" href="#equation-algorithm-rpa-10" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
 X^{(0)\alpha, \beta}_{\sigma\sigma'\sigma_1\sigma_1'}({\bf q},i\omega_n)=
  -\frac{T}{N_L}
  \sum_{\gamma=1}^{n_{\rm orb}}\sum_{{\bf k},n}
  G^{(0)\alpha\beta}_{\sigma\sigma_1', \gamma}({\bf k}+{\bf q}, i\omega_m+ i\epsilon_{n})
  G^{(0)\beta\alpha}_{\sigma_1\sigma', \gamma}({\bf k}, i\epsilon_{n}).
\end{aligned}\]</div>
<p>The array size can be reduced to <span class="math notranslate nohighlight">\(N_{\rm orb}^2 N_{\rm spin}^4 N_k N_{\omega}\)</span>.
Then susceptibility matrix by RPA is obtained as follows:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-11">
<span class="eqno">(5.22)<a class="headerlink" href="#equation-algorithm-rpa-11" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
X^{\alpha, \beta}_{\sigma\sigma'\sigma_1\sigma_1'}(q)&amp;=
X^{(0)\alpha, \beta}_{\sigma\sigma'\sigma_1\sigma_1'}(q) - \sum_{\alpha_1'\beta_1'}
X^{(0)\alpha, \alpha_2}_{\sigma\sigma'\sigma_2\sigma_2'}(q) W^{\alpha_2, \alpha_3}_{\sigma_2\sigma_2', \sigma_3\sigma_3'}({\bf q})X^{\alpha_3, \beta}_{\sigma_3\sigma_3',\sigma_1\sigma_1'}(q).
\end{aligned}\]</div>
<p>If <span class="math notranslate nohighlight">\(\alpha\sigma\sigma'\)</span> is regarded as a single index,
it can be put into matrix form and, as in the case of generalised orbitals, can be used as a</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-12">
<span class="eqno">(5.23)<a class="headerlink" href="#equation-algorithm-rpa-12" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
 \hat{X}(q)&amp;=\hat{X}^{(0)}(q)-\hat{X}^{(0)}(q)\hat{W}(q)\hat{X}(q)\nonumber\\
 &amp;=\left[\hat{I}+\hat{X}^{(0)}(q)\hat{W}(q)\right]^{-1}\hat{X}^{(0)}(q).
\end{aligned}\end{split}\]</div>
<p>The above formula is the general formula for the RPA method.</p>
<p>In the above formula, the calculation of the irreducible susceptibility is performed as follows:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-13">
<span class="eqno">(5.24)<a class="headerlink" href="#equation-algorithm-rpa-13" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
 X^{(0)\alpha, \beta}_{\sigma\sigma'\sigma_1\sigma_1'}({\bf q},i\omega_n)=
  -\frac{T}{N_L}
  \sum_{\gamma=1}^{n_{\rm orb}}\sum_{{\bf k},n}
  G^{(0)\alpha\beta}_{\sigma\sigma_1', \gamma}({\bf k}+{\bf q}, i\omega_m+ i\epsilon_{n})
  G^{(0)\beta\alpha}_{\sigma_1\sigma', \gamma}({\bf k}, i\epsilon_{n})\nonumber
\end{aligned}\]</div>
<p>In this case, the sum of the diagonalized components is required, which is computationally more expensive.
In many previous studies, the one body Green’s function is calculated as follows:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-14">
<span class="eqno">(5.25)<a class="headerlink" href="#equation-algorithm-rpa-14" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
 G^{(0)\alpha\beta}_{\sigma\sigma'}({\bf k}, i\omega_{n}) = \sum_{\gamma=1}^{n_{\rm orb}} G^{(0)\alpha\beta}_{\sigma\sigma', \gamma}({\bf k}, i\omega_{n}).
\end{aligned}\]</div>
<p>The irreducible susceptibility is calculated as follows:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-rpa-15">
<span class="eqno">(5.26)<a class="headerlink" href="#equation-algorithm-rpa-15" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
 X^{(0)\alpha, \beta}_{\sigma\sigma'\sigma_1\sigma_1'}({\bf q},i\omega_n)=
  -\frac{T}{N_L}
  \sum_{{\bf k},n}
  G^{(0)\alpha\beta}_{\sigma\sigma_1'}({\bf k}+{\bf q}, i\omega_m+ i\epsilon_{n})
  G^{(0)\beta\alpha}_{\sigma_1\sigma'}({\bf k}, i\epsilon_{n}).\nonumber
\end{aligned}\]</div>
<p>Though this method may lead to poor accuracy when the diagonalized components are mixed,
there is an advantage that there is no need for technical consideration for <span class="math notranslate nohighlight">\(\gamma\)</span> due to band intersections.
In order to make comparisons with previous studies,
H-Wave has adopted this approach (a mode for correctly handling the Green’s functions and susceptibilities will also be implemented).
It is noted that the vertex correction may be taken into account as a means to consider
higher order correlations. See, for example, reference <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> for the details.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://journals.jps.jp/doi/10.1143/JPSJ.78.104002">K. Yoshimi, T. Kato, H. Maebashi, J. Phys. Soc. Jpn. 78, 104002 (2009).</a></p>
</aside>
</aside>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/Hwave_logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../howtouse/ho-index.html">1. Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uhfr/uhfr-index.html">2. Coordinate-space UHF (UHFr)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uhfk/uhfk-index.html">3. Wave-number space UHF (UHFk)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpa/rpa-index.html">4. Random Phase Approximation (RPA)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="al-index.html">5. Algorithms</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="uhf.html">5.1. Unrestricted Hartree-Fock method</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.2. Random Phase Approximation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgement.html">6. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/app-index.html">7. Appendix</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="al-index.html"><span class="section-number">5. </span>Algorithms</a><ul>
      <li>Previous: <a href="uhf.html" title="previous chapter"><span class="section-number">5.1. </span>Unrestricted Hartree-Fock method</a></li>
      <li>Next: <a href="../acknowledgement.html" title="next chapter"><span class="section-number">6. </span>Acknowledgments</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022-, The University of Tokyo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/algorithm/rpa.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>