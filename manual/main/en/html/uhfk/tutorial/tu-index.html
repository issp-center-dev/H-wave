<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.1. Tutorial &#8212; H-wave Users Guide 1.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=9814fe92" />
    <script src="../../_static/documentation_options.js?v=292eb321"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.2. File specifications" href="../filespecification/fi-index.html" />
    <link rel="prev" title="4. Wave-number space UHF (UHFk)" href="../uhfk-index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tutorial">
<h1><span class="section-number">4.1. </span>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading">¶</a></h1>
<p>To use H-wave in wave-number space (UHFk),
you need to prepare input files:</p>
<ol class="arabic simple">
<li><p>an input parameter file,</p></li>
<li><p>interaction definition files,</p></li>
</ol>
<p>before running the program.
For the latter, you can use the outputs of external programs such as RESPACK,
or you may create the files using the StdFace library.</p>
<p>In the following, we provide a tutorial based on a sample in
<code class="docutils literal notranslate"><span class="pre">docs/tutorial/Hubbard/UHFk</span></code> directory.
The interaction definition files can be generated using StdFace library.
See <a class="reference internal" href="../../appendix/stdface.html#ch-stdface"><span class="std std-ref">Generation of interaction files using StdFace library</span></a> section for the details.</p>
<section id="create-a-parameter-file">
<h2><span class="section-number">4.1.1. </span>Create a parameter file<a class="headerlink" href="#create-a-parameter-file" title="Link to this heading">¶</a></h2>
<p>We prepare an input parameter file that contains basic parameters as well as settings on
inputs and outputs.
A sample file can be found in <code class="docutils literal notranslate"><span class="pre">docs/tutorial/Hubbard/UHFk</span></code> directory by a filename
<code class="docutils literal notranslate"><span class="pre">input.toml</span></code>. The content of the file is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[log]
  print_level = 1
  print_step = 10
[mode]
  mode = &quot;UHFk&quot;
[mode.param]
  # 2Sz = 0
  Ncond = 16
  IterationMax = 1000
  EPS = 8
  Mix = 0.5
  RndSeed = 123456789
  # ene_cutoff = 1.0e+2
  T = 0.0
  CellShape = [ 4, 4, 1 ]
  SubShape = [ 2, 2, 1 ]
[file]
[file.input]
  path_to_input = &quot;&quot;
  # initial = &quot;green_init.dat.npz&quot;
[file.input.interaction]
  path_to_input = &quot;./&quot;
  Geometry = &quot;geom.dat&quot;
  Transfer = &quot;transfer.dat&quot;
  CoulombInter = &quot;coulombinter.dat&quot;
[file.output]
  path_to_output = &quot;output&quot;
  energy = &quot;energy.dat&quot;
  eigen = &quot;eigen&quot;
  green = &quot;green&quot;
</pre></div>
</div>
<p>The file is written in TOML format, and organized by the following sections.</p>
<section id="log-section">
<h3><code class="docutils literal notranslate"><span class="pre">[log]</span></code> section<a class="headerlink" href="#log-section" title="Link to this heading">¶</a></h3>
<p>This section contains settings on log outputs.
<code class="docutils literal notranslate"><span class="pre">print_level</span></code> sets the verbosity of the standard output,
and <code class="docutils literal notranslate"><span class="pre">print_step</span></code> sets the interval of the outputs.</p>
</section>
<section id="mode-section">
<h3><code class="docutils literal notranslate"><span class="pre">[mode]</span></code> section<a class="headerlink" href="#mode-section" title="Link to this heading">¶</a></h3>
<p>This section contains settings on calculation mode and basic parameters.
We choose <code class="docutils literal notranslate"><span class="pre">mode</span></code> to be either the coordinate space UHF (<code class="docutils literal notranslate"><span class="pre">UHFr</span></code>) or the wave-number space UHF (<code class="docutils literal notranslate"><span class="pre">UHFk</span></code>).
The calculation parameters are specified in <code class="docutils literal notranslate"><span class="pre">[mode.param]</span></code> subsection.</p>
</section>
<section id="file-section">
<h3><code class="docutils literal notranslate"><span class="pre">[file]</span></code> section<a class="headerlink" href="#file-section" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">[file.input]</span></code> subsection contains settings
on the directory for the input files by <code class="docutils literal notranslate"><span class="pre">path_to_input</span></code>,
and the filename for the initial configuration by <code class="docutils literal notranslate"><span class="pre">initial</span></code>.
If the latter is not specified, a random configuration will be generated.</p>
<p><code class="docutils literal notranslate"><span class="pre">[file.input.interaction]</span></code> subsection contains a list of files
associated with the geometry information and the interactions distinguished by the keywords.</p>
<p><code class="docutils literal notranslate"><span class="pre">[file.output]</span></code> subsection contains filenames
for the physical observables such as the energy by <code class="docutils literal notranslate"><span class="pre">energy</span></code>,
for the eigenvalues and eigenvectors of the Hamiltonian by <code class="docutils literal notranslate"><span class="pre">eigen</span></code>,
and for the one-body Green’s functions by <code class="docutils literal notranslate"><span class="pre">green</span></code>.
If they are not specified, the corresponding data will not be outputted.</p>
<p>See <a class="reference internal" href="../filespecification/config/index_config.html#ch-config"><span class="std std-ref">Parameter files</span></a> section for the details.</p>
</section>
</section>
<section id="create-interaction-definition-files">
<h2><span class="section-number">4.1.2. </span>Create interaction definition files<a class="headerlink" href="#create-interaction-definition-files" title="Link to this heading">¶</a></h2>
<p>You need to prepare data files on the geometry information of the lattice, and
the coefficients of the interactions required to construct the Hamiltonian.
The association between the types of information and the filenames is provided
in <code class="docutils literal notranslate"><span class="pre">[file.input.interaction]</span></code> section.</p>
<section id="geometry">
<h3><code class="docutils literal notranslate"><span class="pre">Geometry</span></code><a class="headerlink" href="#geometry" title="Link to this heading">¶</a></h3>
<p>The file associated with Geometry provides the geometrical information of the lattice.
An example of the file is shown below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  1.000000000000   0.000000000000   0.000000000000
  0.000000000000   1.000000000000   0.000000000000
  0.000000000000   0.000000000000   1.000000000000
1
    0.000000000000000e+00     0.000000000000000e+00     0.000000000000000e+00
</pre></div>
</div>
<p>It contains the primitive vectors (lines 1–3), the number of orbitals (line 4),
and the Wannier centers of the orbitals (line 5 onwards).</p>
</section>
<section id="transfer-coulombintra-coulombinter-hund-etc">
<h3><code class="docutils literal notranslate"><span class="pre">Transfer</span></code>, <code class="docutils literal notranslate"><span class="pre">CoulombIntra</span></code>, <code class="docutils literal notranslate"><span class="pre">CoulombInter</span></code>, <code class="docutils literal notranslate"><span class="pre">Hund</span></code>, etc<a class="headerlink" href="#transfer-coulombintra-coulombinter-hund-etc" title="Link to this heading">¶</a></h3>
<p>The file associated with Transfer contains the coefficients of Hamiltonian
corresponding to the transfer term of the electron systems.
The coefficients of the two-body interaction terms are stored in the files
associated with the respective keywords.
The defined types include
CoulombIntra, CoulombInter, Hund, Ising, Exchange, PairLift, and PairHop,
in accordance with the coordinate-space UHF.
These files are written in Wannier90(-like) format, as exemplified below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Transfer in wannier90-like format for uhfk
1
9
 1 1 1 1 1 1 1 1 1
  -1    0    0    1    1  -1.000000000000  -0.000000000000
   0   -1    0    1    1  -1.000000000000  -0.000000000000
   0    1    0    1    1  -1.000000000000   0.000000000000
   1    0    0    1    1  -1.000000000000   0.000000000000
</pre></div>
</div>
<p>It contains
a comment (line 1),
the number of orbitals (line 2),
the number of cells <code class="docutils literal notranslate"><span class="pre">nrpts</span></code> of the rectangular cuboid that accommodates translation vectors (line 3),
the multiplicity factors (<code class="docutils literal notranslate"><span class="pre">nrpts</span></code> elements, with 15 elements per line),
and the elements of the coefficient matrix.</p>
<p>Each element of the matrix consists of
translation vector <span class="math notranslate nohighlight">\(r_x, r_y, r_z\)</span>,
indices of orbitals <span class="math notranslate nohighlight">\(\alpha, \beta\)</span>,
and the real and imaginary part of the coefficient.</p>
</section>
</section>
<section id="run">
<h2><span class="section-number">4.1.3. </span>Run<a class="headerlink" href="#run" title="Link to this heading">¶</a></h2>
<p>Once you prepare all the input files, you can perform the calculation
by running H-wave with the input parameter file (<code class="docutils literal notranslate"><span class="pre">input.toml</span></code> in this tutorial)
as an argument.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>hwave<span class="w"> </span>input.toml
</pre></div>
</div>
<p>The calculation starts with the logs as shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>2022-12-02 13:48:11,641 INFO qlms: Read definitions from files
2022-12-02 13:48:11,641 INFO qlms.read_input: QLMSkInput: read Gemoetry from ./geom.dat
2022-12-02 13:48:11,641 INFO qlms.read_input: QLMSkInput: read interaction Transfer from ./transfer.dat
2022-12-02 13:48:11,641 INFO qlms.read_input: QLMSkInput: read interaction CoulombInter from ./coulombinter.dat
2022-12-02 13:48:11,641 INFO qlms: Get Hamiltonian information
2022-12-02 13:48:11,641 INFO qlms: Get Green function information
2022-12-02 13:48:11,667 INFO qlms.uhfk: Show parameters
2022-12-02 13:48:11,668 INFO qlms.uhfk:     Cell Shape     = (4, 4, 1)
2022-12-02 13:48:11,668 INFO qlms.uhfk:     Sub Shape      = (2, 2, 1)
2022-12-02 13:48:11,668 INFO qlms.uhfk:     Block          = (2, 2, 1)
2022-12-02 13:48:11,668 INFO qlms.uhfk:     Block volume   = 4
2022-12-02 13:48:11,668 INFO qlms.uhfk:     Num orbit      = 1
2022-12-02 13:48:11,668 INFO qlms.uhfk:     Num orbit eff  = 4
2022-12-02 13:48:11,668 INFO qlms.uhfk:     nspin          = 2
2022-12-02 13:48:11,668 INFO qlms.uhfk:     nd             = 8
2022-12-02 13:48:11,668 INFO qlms.uhfk:     Ncond          = 16
2022-12-02 13:48:11,669 INFO qlms.uhfk:     T              = 0.0
2022-12-02 13:48:11,669 INFO qlms.uhfk:     E_cutoff       = 100.0
2022-12-02 13:48:11,669 INFO qlms.uhfk:     Mix            = 0.5
2022-12-02 13:48:11,669 INFO qlms.uhfk:     RndSeed        = 123456789
2022-12-02 13:48:11,669 INFO qlms.uhfk:     IterationMax   = 1000
2022-12-02 13:48:11,669 INFO qlms.uhfk:     EPS            = 1e-08
2022-12-02 13:48:11,669 INFO qlms.uhfk:     strict_hermite = False
2022-12-02 13:48:11,669 INFO qlms.uhfk:     hermite_tol    = 1e-08
2022-12-02 13:48:11,669 INFO qlms: Start UHF calculation
2022-12-02 13:48:11,670 INFO qlms.uhfk: Start UHFk calculations
2022-12-02 13:48:11,670 INFO qlms.uhfk: step, rest, energy, NCond, Sz
2022-12-02 13:48:11,671 INFO qlms.uhfk: initialize green function with random numbers
2022-12-02 13:48:11,673 INFO qlms.uhfk: 0, 0.015588886, -139.86928, 16, 1.732e-14 
2022-12-02 13:48:11,684 INFO qlms.uhfk: 10, 0.00043101981, 91.751578, 16, -1.029e-11 
2022-12-02 13:48:11,690 INFO qlms.uhfk: 20, 0.00097917933, 92.129093, 16, -0.0001693 
2022-12-02 13:48:11,694 INFO qlms.uhfk: 30, 0.0002328601, -0.49699902, 16, -2.492e-09 
2022-12-02 13:48:11,697 INFO qlms.uhfk: 40, 8.9087396e-07, -2.2626401, 16, -2.354e-14 
2022-12-02 13:48:11,699 INFO qlms.uhfk: UHFk calculation succeeded: rest=9.905239155412216e-09, eps=1e-08.
2022-12-02 13:48:11,699 INFO qlms: Save calculation results.
2022-12-02 13:48:11,699 INFO qlms.uhfk: save_results: save energy in file output/energy.dat
2022-12-02 13:48:11,699 INFO qlms.uhfk: save_results: save eigenvalues and eigenvectors in file output/eigen.dat
2022-12-02 13:48:11,699 INFO qlms.uhfk: save_results: save green function to file output/green.dat
2022-12-02 13:48:11,700 INFO qlms: All procedures are finished.
--------------------------------------------------------------------------------
Statistics
  function                         :  total elapsed  : average elapsed : ncalls
--------------------------------------------------------------------------------
  hwave.solver.uhfk._init_param    :      0.004 msec :      0.004 msec :      1
  hwave.solver.uhfk._init_lattice  :      0.004 msec :      0.004 msec :      1
  hwave.solver.uhfk._init_orbit    :      0.001 msec :      0.001 msec :      1
  hwave.solver.uhfk._check_interaction :      0.176 msec :      0.176 msec :      1
  hwave.solver.uhfk._reshape_geometry :     23.000 msec :     23.000 msec :      1
  hwave.solver.uhfk._reshape_interaction :      0.222 msec :      0.111 msec :      2
  hwave.solver.uhfk._init_interaction :     23.313 msec :     23.313 msec :      1
  hwave.solver.uhfk._show_param    :      2.149 msec :      2.149 msec :      1
  hwave.solver.uhfk.__init__       :     28.129 msec :     28.129 msec :      1
  hwave.solver.uhfk._make_ham_trans :      0.501 msec :      0.501 msec :      1
  hwave.solver.uhfk._make_ham_inter :      0.414 msec :      0.414 msec :      1
  hwave.solver.uhfk._reshape_green :      0.202 msec :      0.202 msec :      1
  hwave.solver.uhfk._initial_green :      0.494 msec :      0.494 msec :      1
  hwave.solver.uhfk._make_ham      :      6.999 msec :      0.143 msec :     49
  hwave.solver.uhfk._diag          :      3.533 msec :      0.072 msec :     49
  hwave.solver.uhfk._green         :      8.698 msec :      0.178 msec :     49
  hwave.solver.uhfk._calc_energy   :      3.960 msec :      0.081 msec :     49
  hwave.solver.uhfk._calc_phys     :      3.559 msec :      0.073 msec :     49
  hwave.solver.uhfk.solve          :     29.349 msec :     29.349 msec :      1
  hwave.solver.uhfk._deflate_green :      0.035 msec :      0.035 msec :      1
  hwave.solver.uhfk._save_green    :      0.202 msec :      0.202 msec :      1
  hwave.solver.uhfk.save_results   :      0.559 msec :      0.559 msec :      1
--------------------------------------------------------------------------------
</pre></div>
</div>
<p>The logs on the input files are shown, followed by the logs on the iterations of
the wave-number space UHF calculation.
The program will yield, according to the settings in <code class="docutils literal notranslate"><span class="pre">[file.output]</span></code> section,
the output files <code class="docutils literal notranslate"><span class="pre">energy.dat</span></code>, <code class="docutils literal notranslate"><span class="pre">eigen.npz</span></code>, and <code class="docutils literal notranslate"><span class="pre">green.npz</span></code> in <code class="docutils literal notranslate"><span class="pre">output</span></code> directory.</p>
<p>See <a class="reference internal" href="../filespecification/outputfiles_uhfk/index_outputfiles_uhfk.html#sec-outputfile-uhfk"><span class="std std-ref">Output files of UHFk</span></a> section for the details of the output files.</p>
</section>
<section id="calculate-density-of-state-hwave-dos">
<h2><span class="section-number">4.1.4. </span>Calculate density of state  (<code class="docutils literal notranslate"><span class="pre">hwave_dos</span></code>)<a class="headerlink" href="#calculate-density-of-state-hwave-dos" title="Link to this heading">¶</a></h2>
<p>You can calculate the density of states (DOS) using the post-processing tool, <code class="docutils literal notranslate"><span class="pre">hwave_dos</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">hwave_dos</span></code> uses the <code class="docutils literal notranslate"><span class="pre">libtetrabz</span></code> library to integrating over the Brillouin zone.
<code class="docutils literal notranslate"><span class="pre">libtetrabz</span></code> can be installed by <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ python3 -m pip install libtetrabz
</pre></div>
</div>
<p>The tool requires the input parameter file used in the calculation.
The following example shows how to calculate the DOS using the sample input file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ hwave_dos input.toml
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hwave_dos</span></code> outputs the DOS file, <code class="docutils literal notranslate"><span class="pre">dos.dat</span></code> in the directory specified by the <code class="docutils literal notranslate"><span class="pre">file.output.path_to_output</span></code> of the input file.
The filename can be changed by <code class="docutils literal notranslate"><span class="pre">--output</span></code> option:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ hwave_dos input.toml --output dos.dat
</pre></div>
</div>
<p>The DOS is calculated in the energy range specified by <code class="docutils literal notranslate"><span class="pre">--ene-window</span></code> option.
If omitted, the energy range is set to <span class="math notranslate nohighlight">\([E_\text{min}-0.2, E_\text{max}+0.2]\)</span> where <span class="math notranslate nohighlight">\(E_\text{min}\)</span> and <span class="math notranslate nohighlight">\(E_\text{max}\)</span> are the minimum and maximum energies obtained by <code class="docutils literal notranslate"><span class="pre">hwave</span></code>.
The number of the energy points for the DOS calculation is specified by <code class="docutils literal notranslate"><span class="pre">--ene-num</span></code> option (default is 101):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ hwave_dos input.toml --ene-window -10.0 5.0 --ene-num 201
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--plot</span></code> option plots the DOS. <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> is required:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ hwave_dos input.toml --plot dos.png
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/Hwave_logo.png" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">1. What is H-wave?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howtouse/ho-index.html">2. Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uhfr/uhfr-index.html">3. Coordinate-space UHF (UHFr)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../uhfk-index.html">4. Wave-number space UHF (UHFk)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.1. Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-parameter-file">4.1.1. Create a parameter file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-interaction-definition-files">4.1.2. Create interaction definition files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run">4.1.3. Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculate-density-of-state-hwave-dos">4.1.4. Calculate density of state  (<code class="docutils literal notranslate"><span class="pre">hwave_dos</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../filespecification/fi-index.html">4.2. File specifications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rpa/rpa-index.html">5. Random Phase Approximation (RPA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithm/al-index.html">6. Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgement.html">7. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/app-index.html">8. Appendix</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../uhfk-index.html"><span class="section-number">4. </span>Wave-number space UHF (UHFk)</a><ul>
      <li>Previous: <a href="../uhfk-index.html" title="previous chapter"><span class="section-number">4. </span>Wave-number space UHF (UHFk)</a></li>
      <li>Next: <a href="../filespecification/fi-index.html" title="next chapter"><span class="section-number">4.2. </span>File specifications</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2022-, The University of Tokyo.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../_sources/uhfk/tutorial/tu-index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>