<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.1. Tutorial &#8212; H-wave Users Guide 1.1-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=66c3864b" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=080225cb"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.2. File specifications" href="../filespecification/fi-index.html" />
    <link rel="prev" title="5. Random Phase Approximation (RPA)" href="../rpa-index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tutorial">
<h1><span class="section-number">5.1. </span>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this heading">¶</a></h1>
<p>To use H-wave for the calculation of Random Phase Approximation (RPA),
you need to prepare input files:</p>
<ol class="arabic simple">
<li><p>an input parameter file,</p></li>
<li><p>interaction definition files,</p></li>
</ol>
<p>before running the program.</p>
<p>In the following, we provide a tutorial based on a sample in
<code class="docutils literal notranslate"><span class="pre">docs/tutorial/Hubbard/RPA</span></code> directory.
The interaction definition files can be generated using StdFace library.
See <a class="reference internal" href="../../appendix/stdface.html#ch-stdface"><span class="std std-ref">Generation of interaction files using StdFace library</span></a> section for the details.</p>
<section id="create-a-parameter-file">
<h2><span class="section-number">5.1.1. </span>Create a parameter file<a class="headerlink" href="#create-a-parameter-file" title="Permalink to this heading">¶</a></h2>
<p>We prepare an input parameter file that contains basic parameters as well as settings on
inputs and outputs.
A sample file can be found in <code class="docutils literal notranslate"><span class="pre">docs/tutorial/Hubbard/RPA</span></code> directory by a filename
<code class="docutils literal notranslate"><span class="pre">input.toml</span></code>. The content of the file is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[log]
  print_level = 1

[mode]
  mode = &quot;RPA&quot;

[mode.param]
  T = 0.5
  # mu = 0.0
  CellShape = [32,32,1]
  SubShape = [1,1,1]
  nmat = 1024
  # Ncond = 1024
  filling = 0.5
  matsubara_frequency = &quot;all&quot;

[file]
[file.input]
  path_to_input = &quot;input&quot;
  # initial = &quot;initial.dat&quot;
  # chi0q_init = &quot;chi0q.npz&quot;

[file.input.interaction]
  path_to_input = &quot;.&quot;
  Geometry = &quot;geom.dat&quot;
  Transfer = &quot;transfer.dat&quot;
  CoulombIntra = &quot;coulombintra.dat&quot;
  CoulombInter = &quot;coulombinter.dat&quot;

[file.output]
  path_to_output = &quot;output&quot;
  chiq = &quot;chiq&quot;
  chi0q = &quot;chi0q&quot;

</pre></div>
</div>
<p>The file is written in TOML format, and organized by the following sections.</p>
<section id="log-section">
<h3><code class="docutils literal notranslate"><span class="pre">[log]</span></code> section<a class="headerlink" href="#log-section" title="Permalink to this heading">¶</a></h3>
<p>This section contains settings on log outputs.
<code class="docutils literal notranslate"><span class="pre">print_level</span></code> sets the verbosity of the standard output,
and <code class="docutils literal notranslate"><span class="pre">print_step</span></code> sets the interval of the outputs.</p>
</section>
<section id="mode-section">
<h3><code class="docutils literal notranslate"><span class="pre">[mode]</span></code> section<a class="headerlink" href="#mode-section" title="Permalink to this heading">¶</a></h3>
<p>This section contains settings on calculation mode and basic parameters.
We choose <code class="docutils literal notranslate"><span class="pre">mode</span></code> to be <code class="docutils literal notranslate"><span class="pre">&quot;RPA&quot;</span></code>.
The calculation parameters are specified in <code class="docutils literal notranslate"><span class="pre">[mode.param]</span></code> subsection.</p>
</section>
<section id="file-section">
<h3><code class="docutils literal notranslate"><span class="pre">[file]</span></code> section<a class="headerlink" href="#file-section" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">[file.input]</span></code> subsection contains settings
on the directory for the input files by <code class="docutils literal notranslate"><span class="pre">path_to_input</span></code>.
It is possible to read the pre-calculated irreducible susceptibility
<span class="math notranslate nohighlight">\(\chi_0(\vec{q})\)</span> from a file specified by <code class="docutils literal notranslate"><span class="pre">chi0q_init</span></code> and calculate
the susceptibility.</p>
<p><code class="docutils literal notranslate"><span class="pre">[file.input.interaction]</span></code> subsection contains a list of files
associated with the geometry information and the interactions distinguished by the keywords.</p>
<p><code class="docutils literal notranslate"><span class="pre">[file.output]</span></code> subsection contains filenames
for the physical observables such as the energy by <code class="docutils literal notranslate"><span class="pre">energy</span></code>,
for the eigenvalues and eigenvectors of the Hamiltonian by <code class="docutils literal notranslate"><span class="pre">eigen</span></code>,
and for the one-body Green’s functions by <code class="docutils literal notranslate"><span class="pre">green</span></code>.
If they are not specified, the corresponding data will not be outputted.</p>
<p>See <a class="reference internal" href="../filespecification/config/index_config.html#ch-config-rpa"><span class="std std-ref">Parameter files</span></a> section for the details.</p>
</section>
</section>
<section id="create-interaction-definition-files">
<h2><span class="section-number">5.1.2. </span>Create interaction definition files<a class="headerlink" href="#create-interaction-definition-files" title="Permalink to this heading">¶</a></h2>
<p>You need to prepare data files on the geometry information of the lattice, and
the coefficients of the interactions required to construct the Hamiltonian.
The association between the types of information and the filenames is provided
in <code class="docutils literal notranslate"><span class="pre">[file.input.interaction]</span></code> section.</p>
<section id="geometry">
<h3><code class="docutils literal notranslate"><span class="pre">Geometry</span></code><a class="headerlink" href="#geometry" title="Permalink to this heading">¶</a></h3>
<p>The file associated with Geometry provides the geometrical information of the lattice.
An example of the file is shown below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  1.000000000000   0.000000000000   0.000000000000
  0.000000000000   1.000000000000   0.000000000000
  0.000000000000   0.000000000000   1.000000000000
1
    0.000000000000000e+00     0.000000000000000e+00     0.000000000000000e+00
</pre></div>
</div>
<p>It contains the primitive vectors (lines 1–3), the number of orbitals (line 4),
and the Wannier centers of the orbitals (line 5 onwards).</p>
</section>
<section id="transfer-coulombintra-coulombinter-hund-etc">
<h3><code class="docutils literal notranslate"><span class="pre">Transfer</span></code>, <code class="docutils literal notranslate"><span class="pre">CoulombIntra</span></code>, <code class="docutils literal notranslate"><span class="pre">CoulombInter</span></code>, <code class="docutils literal notranslate"><span class="pre">Hund</span></code>, etc<a class="headerlink" href="#transfer-coulombintra-coulombinter-hund-etc" title="Permalink to this heading">¶</a></h3>
<p>The file associated with Transfer contains the coefficients of Hamiltonian
corresponding to the transfer term of the electron systems.
The coefficients of the two-body interaction terms are stored in the files
associated with the respective keywords.
The defined types include
CoulombIntra, CoulombInter, Hund, Ising, Exchange, PairLift, and PairHop,
in accordance with the UHF calculation.
These files are written in Wannier90(-like) format, as exemplified below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Transfer in wannier90-like format for uhfk
1
9
 1 1 1 1 1 1 1 1 1
  -1   -1    0    1    1  0.500000000000  -0.000000000000
  -1    0    0    1    1  1.000000000000  -0.000000000000
   0   -1    0    1    1  1.000000000000  -0.000000000000
   0    1    0    1    1  1.000000000000   0.000000000000
   1    0    0    1    1  1.000000000000   0.000000000000
   1    1    0    1    1  0.500000000000   0.000000000000
</pre></div>
</div>
<p>It contains
a comment (line 1),
the number of orbitals (line 2),
<code class="docutils literal notranslate"><span class="pre">nrpts</span></code> (line 3),
the multiplicity factors (<code class="docutils literal notranslate"><span class="pre">nrpts</span></code> elements, with 15 elements per line),
and the elements of the coefficient matrix.
<code class="docutils literal notranslate"><span class="pre">nrpts</span></code> denotes the number of cells of the rectangular cuboid that is spanned by the
lower and upper ends of the translation vectors along x, y, and z axes.</p>
<p>Each element of the matrix consists of
translation vector <span class="math notranslate nohighlight">\(r_x, r_y, r_z\)</span>,
indices of orbitals <span class="math notranslate nohighlight">\(\alpha, \beta\)</span>,
and the real and imaginary part of the coefficient.</p>
</section>
</section>
<section id="run">
<h2><span class="section-number">5.1.3. </span>Run<a class="headerlink" href="#run" title="Permalink to this heading">¶</a></h2>
<p>Once you prepare all the input files, you can perform the calculation
by running H-wave with the input parameter file (<code class="docutils literal notranslate"><span class="pre">input.toml</span></code> in this tutorial)
as an argument.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>hwave<span class="w"> </span>input.toml
</pre></div>
</div>
<p>The calculation starts with the logs as shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>2023-03-07 18:55:44,682 INFO qlms: RPA mode
2023-03-07 18:55:44,682 INFO qlms: Read interaction definitions from files
2023-03-07 18:55:44,682 INFO qlms.read_input: QLMSkInput: read Gemoetry from input/geom.dat
2023-03-07 18:55:44,682 INFO qlms.read_input: QLMSkInput: read interaction Transfer from input/transfer.dat
2023-03-07 18:55:44,682 INFO qlms.read_input: QLMSkInput: read interaction CoulombIntra from input/coulombintra.dat
2023-03-07 18:55:44,682 INFO qlms.read_input: QLMSkInput: read interaction CoulombInter from input/coulombinter.dat
2023-03-07 18:55:44,682 INFO hwave.solver.rpa: Lattice parameters:
2023-03-07 18:55:44,682 INFO hwave.solver.rpa:     CellShape       = (32, 32, 1)
2023-03-07 18:55:44,682 INFO hwave.solver.rpa:     cell volume     = 1024
2023-03-07 18:55:44,682 INFO hwave.solver.rpa:     cell dimension  = 3
2023-03-07 18:55:44,682 INFO hwave.solver.rpa:     SubShape        = (1, 1, 1)
2023-03-07 18:55:44,682 INFO hwave.solver.rpa:     subshape volume = 1
2023-03-07 18:55:44,682 INFO hwave.solver.rpa:     Shape           = (32, 32, 1)
2023-03-07 18:55:44,682 INFO hwave.solver.rpa:     shape volume    = 1024
2023-03-07 18:55:44,682 INFO hwave.solver.rpa:     has_sublattice  = False
2023-03-07 18:55:44,683 INFO hwave.solver.rpa: RPA parameters:
2023-03-07 18:55:44,683 INFO hwave.solver.rpa:     norbit          = 1
2023-03-07 18:55:44,683 INFO hwave.solver.rpa:     nspin           = 2
2023-03-07 18:55:44,683 INFO hwave.solver.rpa:     nd              = 2
2023-03-07 18:55:44,683 INFO hwave.solver.rpa:     Nmat            = 1024
2023-03-07 18:55:44,683 INFO hwave.solver.rpa:     mu              = 0.0
2023-03-07 18:55:44,683 INFO hwave.solver.rpa:     T               = 0.5
2023-03-07 18:55:44,683 INFO hwave.solver.rpa:     E_cutoff        = 1.000000e+02
2023-03-07 18:55:44,683 INFO qlms: Start UHF calculation
2023-03-07 18:55:44,683 INFO hwave.solver.rpa: Start RPA calculations
2023-03-07 18:55:47,726 INFO hwave.solver.rpa: End RPA calculations
2023-03-07 18:55:47,726 INFO qlms: Save calculation results.
2023-03-07 18:55:47,726 INFO hwave.solver.rpa: Save RPA results
2023-03-07 18:55:47,925 INFO hwave.solver.rpa: save_results: save chiq in file output/chiq
2023-03-07 18:55:48,294 INFO hwave.solver.rpa: save_results: save chi0q in file output/chi0q
2023-03-07 18:55:48,294 INFO qlms: All procedures are finished.
--------------------------------------------------------------------------------
Statistics
  function                         :  total elapsed  : average elapsed : ncalls
--------------------------------------------------------------------------------
  hwave.solver.rpa.__init__        :      1.037 msec :      1.037 msec :      1
  hwave.solver.rpa.read_init       :      0.001 msec :      0.001 msec :      1
  hwave.solver.rpa._calc_epsilon_k :     22.587 msec :     22.587 msec :      1
  hwave.solver.rpa._calc_green     :    130.035 msec :    130.035 msec :      1
  hwave.solver.rpa._calc_chi0q     :   1886.201 msec :   1886.201 msec :      1
  hwave.solver.rpa._solve_rpa      :   1003.617 msec :   1003.617 msec :      1
  hwave.solver.rpa.solve           :   3042.926 msec :   3042.926 msec :      1
  hwave.solver.rpa.save_results    :    567.897 msec :    567.897 msec :      1
--------------------------------------------------------------------------------
</pre></div>
</div>
<p>The logs on the input files are shown, followed by the logs on the process of RPA calculations.
The program will yield, according to the settings in <code class="docutils literal notranslate"><span class="pre">[file.output]</span></code> section,
the output files <code class="docutils literal notranslate"><span class="pre">chi0q.npz</span></code> and <code class="docutils literal notranslate"><span class="pre">chiq.npz</span></code> in <code class="docutils literal notranslate"><span class="pre">output</span></code> directory.</p>
<p>See <a class="reference internal" href="../filespecification/outputfiles/index_outputfiles.html#sec-outputfile-rpa"><span class="std std-ref">Output files of RPA</span></a> section for the details of the output files.</p>
<p>A tool is prepared in <code class="docutils literal notranslate"><span class="pre">sample/RPA/view.py</span></code> for visualizing the calculation results
as a post-process.
Let us copy the script file to the current directory, and run the script as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python3<span class="w"> </span>view.py
</pre></div>
</div>
<p>The script reads <code class="docutils literal notranslate"><span class="pre">output/chi0q.npz</span></code> and <code class="docutils literal notranslate"><span class="pre">output/chiq.npz</span></code>, and writes the values of
the charge susceptibility <span class="math notranslate nohighlight">\(\chi_c(\vec{q})\)</span>
and the spin susceptibility <span class="math notranslate nohighlight">\(\chi_s(\vec{q})\)</span>
at Matsubara frequency <span class="math notranslate nohighlight">\({\rm i}\omega_m=0\)</span>
for each <span class="math notranslate nohighlight">\(\vec{q}\)</span>
to the standard output.
It also produces the figures of these quantities in PNG format shown as below:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="id1">
<img alt="../../_images/chic.png" src="../../_images/chic.png" />
<figcaption>
<p><span class="caption-number">Fig. 5.1 </span><span class="caption-text"><span class="math notranslate nohighlight">\(\chi_c(\vec{q})\)</span></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="id2">
<img alt="../../_images/chis.png" src="../../_images/chis.png" />
<figcaption>
<p><span class="caption-number">Fig. 5.2 </span><span class="caption-text"><span class="math notranslate nohighlight">\(\chi_s(\vec{q})\)</span></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/Hwave_logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">1. What is H-wave?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howtouse/ho-index.html">2. Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uhfr/uhfr-index.html">3. Coordinate-space UHF (UHFr)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../uhfk/uhfk-index.html">4. Wave-number space UHF (UHFk)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../rpa-index.html">5. Random Phase Approximation (RPA)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.1. Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-a-parameter-file">5.1.1. Create a parameter file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-interaction-definition-files">5.1.2. Create interaction definition files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run">5.1.3. Run</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../filespecification/fi-index.html">5.2. File specifications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../algorithm/al-index.html">6. Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgement.html">7. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/app-index.html">8. Appendix</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../rpa-index.html"><span class="section-number">5. </span>Random Phase Approximation (RPA)</a><ul>
      <li>Previous: <a href="../rpa-index.html" title="previous chapter"><span class="section-number">5. </span>Random Phase Approximation (RPA)</a></li>
      <li>Next: <a href="../filespecification/fi-index.html" title="next chapter"><span class="section-number">5.2. </span>File specifications</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022-, The University of Tokyo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/rpa/tutorial/tu-index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>