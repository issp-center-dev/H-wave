<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.1. Unrestricted Hartree-Fock method &#8212; H-wave Users Guide 1.1-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=9814fe92" />
    <script src="../_static/documentation_options.js?v=5f12b55d"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.2. Random Phase Approximation" href="rpa.html" />
    <link rel="prev" title="6. Algorithms" href="al-index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="unrestricted-hartree-fock-method">
<span id="algorithm-sec"></span><h1><span class="section-number">6.1. </span>Unrestricted Hartree-Fock method<a class="headerlink" href="#unrestricted-hartree-fock-method" title="Link to this heading">¶</a></h1>
<section id="overview">
<h2><span class="section-number">6.1.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The unrestricted Hartree-Fock approximation is a method to approximate
two-body interactions into one-body terms by taking account of the fluctuation
of the one-body operators up to first order.
For a general two-body interactions, it leads to the following approximation:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-0">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-algorithm-uhf-0" title="Link to this equation">¶</a></span>\[\begin{split}\begin{aligned}
c_{i}^{\dagger} c_{j}^{\dagger} c_{k} c_{l}
&amp; \sim
\langle c_{i}^{\dagger} c_l \rangle c_{j}^{\dagger} c_k
+ c_{i}^{\dagger} c_l \langle c_{j}^{\dagger} c_k\rangle
- \langle c_{i}^{\dagger} c_k \rangle c_{j}^{\dagger} c_l
- c_{i}^{\dagger} c_k \langle c_{j}^{\dagger} c_l \rangle \nonumber \\
&amp; \qquad
- (\langle c_{i}^{\dagger} c_l \rangle \langle c_{j}^{\dagger} c_k \rangle
- \langle c_{i}^{\dagger} c_k\rangle \langle c_{j}^{\dagger} c_l\rangle) .
\end{aligned}\end{split}\]</div>
<p>In H-wave, the two-body interaction terms are defined as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-1">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-algorithm-uhf-1" title="Link to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\mathcal{H}_\text{InterAll}
&amp;=
\sum_{ijkl\alpha\beta\gamma\delta} \sum_{\sigma_1 \sigma_2 \sigma_3 \sigma_4}
I_{ijkl\alpha\beta\gamma\delta}
c^\dagger_{i\alpha\sigma_1} c_{j\beta\sigma_2} c^\dagger_{k\gamma\sigma_3} c_{l\delta\sigma_4}
\nonumber\\
&amp;=
\sum_{ijkl\alpha\beta\gamma\delta} \sum_{\sigma_1 \sigma_2 \sigma_3 \sigma_4}
I_{ijkl\alpha\beta\gamma\delta} (
c^\dagger_{i\alpha\sigma_1} c^\dagger_{k\gamma\sigma_3} c_{l\gamma\sigma_4} c_{j\beta\sigma_2}
+ c^\dagger_{i\alpha\sigma_1} c_{l\delta\sigma_4} \delta_{j,k}\delta_{\beta,\gamma}\delta_{\sigma_2,\sigma_3} ) .
\end{aligned}\end{split}\]</div>
<p>It is noted that there is a one-body term as depicted in the second term of
the above expression.
Then, the Hamiltonian given by the one-body terms is generally denoted as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-2">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-algorithm-uhf-2" title="Link to this equation">¶</a></span>\[\begin{aligned}
\mathcal{H}_\text{UHF} &amp;= \sum_{ij} H_{ij} c^\dagger_{i} c_{j} = \hat{c}^\dagger H \hat{c}
\end{aligned}\]</div>
<p>where we adopt a notation <span class="math notranslate nohighlight">\(i\equiv(i, \alpha, \sigma_1), j\equiv(j, \beta, \sigma_2)\)</span> for brevity,
<span class="math notranslate nohighlight">\(H\)</span> denotes a matrix whose elements are <span class="math notranslate nohighlight">\(H_{ij}\)</span>, and
<span class="math notranslate nohighlight">\(\hat{c}\)</span> denotes a column vector whose elements are <span class="math notranslate nohighlight">\(c_{i}\)</span>.</p>
<p>As <span class="math notranslate nohighlight">\(H\)</span> is an Hermite matrix,
the Hamiltonian can be transformed into <span class="math notranslate nohighlight">\(H=U \hat{\xi} U^\dagger\)</span>
where
<span class="math notranslate nohighlight">\(\hat{\xi}\)</span> is a matrix whose diagonal elements are the eigenvalues of <span class="math notranslate nohighlight">\(H\)</span>,
and <span class="math notranslate nohighlight">\(U\)</span> is a matrix composed of the corresponding eigenvectors.</p>
<p>Then, let <span class="math notranslate nohighlight">\(\hat{d} = U^\dagger \hat{c}\)</span>, and <span class="math notranslate nohighlight">\(\mathcal{H}_\text{UHF}\)</span> leads to</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-3">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-algorithm-uhf-3" title="Link to this equation">¶</a></span>\[\begin{aligned}
\mathcal{H}_\text{UHF} &amp;= \hat{d}^\dagger \hat{\xi} \hat{d} =  \sum_{k} \xi_k d_k^\dagger d_k .
\end{aligned}\]</div>
<p>Therefore, the energy derived from the one-body interaction term of the UHF approximation
is obtained by</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-4">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-algorithm-uhf-4" title="Link to this equation">¶</a></span>\[\begin{aligned}
E_\text{UHF} = \langle \mathcal{H}_\text{UHF} \rangle = \sum_{k} \xi_k \langle d_k^\dagger d_k \rangle .
\end{aligned}\]</div>
<p>In the numerical calculation, as <span class="math notranslate nohighlight">\(H\)</span> depends on the one-body Green’s function
<span class="math notranslate nohighlight">\(\langle c_{i}^\dagger c_{j}\rangle\)</span>
through the UHF approximation, the equation is iteratively solved to satisfy the self-consistency.
Starting from a one-body Green’s function given as an initial value, it is updated through the relation</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-5">
<span class="eqno">(6.6)<a class="headerlink" href="#equation-algorithm-uhf-5" title="Link to this equation">¶</a></span>\[\begin{aligned}
\langle c_{i}^\dagger c_{j}\rangle = \sum_{l} U_{il}^* U_{jl} \langle d_l^\dagger d_l \rangle = \sum_{l} \frac{U_{il}^* U_{jl}}{1+\exp^{\beta(\xi_l -\mu)}}
\end{aligned}\]</div>
<p>until the one-body Green’s function converges.
Here, <span class="math notranslate nohighlight">\(\beta\)</span> denotes the inverse temperature <span class="math notranslate nohighlight">\(1/ k_B T\)</span>, and
<span class="math notranslate nohighlight">\(\mu\)</span> denotes the chemical potential.
In the canonical calculation in which the number of particles is fixed,
<span class="math notranslate nohighlight">\(\mu\)</span> is determined to satisfy the relation</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-6">
<span class="eqno">(6.7)<a class="headerlink" href="#equation-algorithm-uhf-6" title="Link to this equation">¶</a></span>\[\begin{aligned}
N = \sum_{i} \langle c_i^{\dagger} c_i \rangle
\end{aligned}\]</div>
<p>for the number of particles <span class="math notranslate nohighlight">\(N\)</span> at every step.</p>
<p>In H-wave, the simple-mixing algorithm is employed to update the configuration.
If we denote the one-body Green’s function at <em>n</em>-th step by
<span class="math notranslate nohighlight">\(\langle c_{i}^\dagger c_{j}\rangle^{(n)}\)</span>,
the Green’s function at <em>n+1</em>-th step is chosen by mixing that of <em>n</em>-th step
with the new one obtained in <em>n+1</em>-th step as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-7">
<span class="eqno">(6.8)<a class="headerlink" href="#equation-algorithm-uhf-7" title="Link to this equation">¶</a></span>\[\begin{aligned}
\langle c_{i}^\dagger c_{j}\rangle^{(n+1)} := (1-\alpha) \langle c_{i}^\dagger c_{j}\rangle^{(n)} +  \alpha \langle c_{i}^\dagger c_{j}\rangle^{(n+1)},
\end{aligned}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is a parameter between 0 and 1.
There are other update algorithms such as Anderson mixing, though they are not supported
in the present version of H-wave.</p>
<p>In the coordinate-space UHF mode of H-wave, all interactions are mapped to InterAll form.
The free energy at finite temperature is given by</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-8">
<span class="eqno">(6.9)<a class="headerlink" href="#equation-algorithm-uhf-8" title="Link to this equation">¶</a></span>\[\begin{aligned}
F = \mu N -\frac{1}{\beta}\sum_k \ln \left[ 1+\exp (-\beta(\xi_k - \mu)) \right]
 - \sum_{ijkl} I_{ijkl} (\langle c_{i}^{\dagger} c_j\rangle \langle c_{k}^{\dagger} c_l\rangle - \langle c_{i}^{\dagger} c_l\rangle \langle c_{k}^{\dagger} c_j\rangle) .
\end{aligned}\]</div>
</section>
<section id="extension-to-wave-number-space">
<h2><span class="section-number">6.1.2. </span>Extension to wave-number space<a class="headerlink" href="#extension-to-wave-number-space" title="Link to this heading">¶</a></h2>
<p>The Hamiltonian given by the one-body terms is rewritten in the wave-number representation
by the Fourier transform <span class="math notranslate nohighlight">\(c_i = \dfrac{1}{\sqrt{V}} \sum_k e^{ikr_i} c_k\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-uhf-9">
<span class="eqno">(6.10)<a class="headerlink" href="#equation-algorithm-uhf-9" title="Link to this equation">¶</a></span>\[\begin{aligned}
\mathcal{H}_\text{UHF}
&amp;=
\sum_{k\alpha\beta\sigma\sigma^\prime}
h_{\alpha\beta\sigma\sigma^\prime}(k)\,
c_{k\alpha\sigma}^\dagger c_{k\beta\sigma^\prime}^{\phantom\dagger}
\end{aligned}\]</div>
<p>Here, the interaction is assumed to have translational symmetry so that
the coefficients depend only on the translation vectors <span class="math notranslate nohighlight">\(r_{ij}=r_j - r_i\)</span>.
It is noted that InterAll type of interaction is not considered in the
wave-number space UHF mode.</p>
<p>As the Hamiltonian is diagonal with respect to the wave number <span class="math notranslate nohighlight">\(k\)</span>,
the calculation of the eigenvalues and eigenvectors reduces from
diagonalization of a matrix of the size
<span class="math notranslate nohighlight">\(N_\text{site}N_\text{orbit} \times N_\text{site}N_\text{orbit}\)</span>
to that of <span class="math notranslate nohighlight">\(N_\text{site}\)</span> matrices of the size
<span class="math notranslate nohighlight">\(N_\text{orbit} \times N_\text{orbit}\)</span>,
which lowers the calculation costs.
Here,
<span class="math notranslate nohighlight">\(N_\text{site}\)</span> denotes the number of sites, and
<span class="math notranslate nohighlight">\(N_\text{orbit}\)</span> denotes the number of orbitals including the spin degree of freedom.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/Hwave_logo.png" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">1. What is H-wave?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtouse/ho-index.html">2. Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uhfr/uhfr-index.html">3. Coordinate-space UHF (UHFr)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uhfk/uhfk-index.html">4. Wave-number space UHF (UHFk)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rpa/rpa-index.html">5. Random Phase Approximation (RPA)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="al-index.html">6. Algorithms</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">6.1. Unrestricted Hartree-Fock method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">6.1.1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extension-to-wave-number-space">6.1.2. Extension to wave-number space</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rpa.html">6.2. Random Phase Approximation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgement.html">7. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/app-index.html">8. Appendix</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="al-index.html"><span class="section-number">6. </span>Algorithms</a><ul>
      <li>Previous: <a href="al-index.html" title="previous chapter"><span class="section-number">6. </span>Algorithms</a></li>
      <li>Next: <a href="rpa.html" title="next chapter"><span class="section-number">6.2. </span>Random Phase Approximation</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2022-, The University of Tokyo.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/algorithm/uhf.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>