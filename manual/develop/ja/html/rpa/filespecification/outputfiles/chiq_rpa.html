<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>chiq, chi0q &#8212; H-waveマニュアル 1.0.0 ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=66c3864b" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=36365ade"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/translations.js?v=4dbe4bdc"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="検索" href="../../../search.html" />
    <link rel="next" title="6. アルゴリズム" href="../../../algorithm/al-index.html" />
    <link rel="prev" title="5.2.3. RPAの出力ファイル" href="index_outputfiles.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="chiq-chi0q">
<span id="subsec-chiq-rpa"></span><h1>chiq, chi0q<a class="headerlink" href="#chiq-chi0q" title="この見出しへのパーマリンク">¶</a></h1>
<p>感受率行列および既約感受率行列の計算結果を Numpy zip 形式で出力します。
ファイル名は、環境設定ファイルの中の <code class="docutils literal notranslate"><span class="pre">file.output</span></code> セクションでキーワード <code class="docutils literal notranslate"><span class="pre">chiq</span></code> および <code class="docutils literal notranslate"><span class="pre">chi0q</span></code> を用いて指定された文字列(以下 <code class="docutils literal notranslate"><span class="pre">chiq_str</span></code> と記述)を用いて、 <code class="docutils literal notranslate"><span class="pre">chiq_str.npz</span></code> という名前で出力されます。</p>
<p>ファイルの内容は、以下のキーにバインドされる複数の配列データからなります。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">chiq</span></code> または <code class="docutils literal notranslate"><span class="pre">chi0q</span></code>:</p>
<p>感受率行列または既約感受率行列のデータ。データ形式は以下の節で説明します。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">freq_index</span></code>:</p>
<p>出力する松原振動数の値または範囲はパラメータ <code class="docutils literal notranslate"><span class="pre">matsubara_frequency</span></code> で指定されます。出力データの配列インデックスと、実際の松原振動数のラベルの対応付けを <code class="docutils literal notranslate"><span class="pre">freq_index</span></code> に格納します。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">wavevector_unit</span></code> および <code class="docutils literal notranslate"><span class="pre">wavevector_index</span></code>:</p>
<p>波数ベクトルの情報を格納します。詳細は <a class="reference internal" href="../../../uhfk/filespecification/outputfiles_uhfk/eigen_uhfk.html#subsec-eigen-uhfk-dat"><span class="std std-ref">UHFk の出力ファイル</span></a> を参照してください。</p>
</li>
</ul>
<p>副格子を指定している場合は、出力されるデータは副格子を単位とした感受率の値です。波数ベクトルおよび軌道のインデックスは副格子に読み替えます。</p>
<p><code class="docutils literal notranslate"><span class="pre">chi0q</span></code> の出力ファイルは、計算済み既約感受率データとして <code class="docutils literal notranslate"><span class="pre">file.input</span></code> セクションの <code class="docutils literal notranslate"><span class="pre">chi0q_init</span></code> に指定して使用できます。</p>
</section>
<section id="chi0q">
<h1>chi0q のデータ形式<a class="headerlink" href="#chi0q" title="この見出しへのパーマリンク">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">chi0q</span></code> のデータ形式は、スピン軌道相互作用および外場の有無と、 <code class="docutils literal notranslate"><span class="pre">mode.calc_scheme</span></code> パラメータの値によって以下の形をとります。</p>
<ul>
<li><p>スピン非依存 (spin-free):</p>
<p><code class="docutils literal notranslate"><span class="pre">enable_spin_orbital</span></code> パラメータが <code class="docutils literal notranslate"><span class="pre">false</span></code> の場合、もしくは <code class="docutils literal notranslate"><span class="pre">true</span></code> であっても <span class="math notranslate nohighlight">\(T_{\tilde\alpha\tilde\beta}(k)\)</span> がスピンについて対角かつ対称な場合で、外場がないとき、既約感受率行列のスピン非依存部分を出力します。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">general</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(l,q,a,ap,b,bp)</span></code> で、インデックスは以下のとおりです</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code>: 松原振動数のラベル。インデックスとラベルの対応は前述の <code class="docutils literal notranslate"><span class="pre">freq_index</span></code> で与えられます。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> : 波数ベクトルのインデックス <span class="math notranslate nohighlight">\([q_x\ q_y\ q_z]\)</span> を1次元化したインデックスで、 <span class="math notranslate nohighlight">\(q = q_z + N_z \cdot (q_y + N_y \cdot q_x)\)</span> となります。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">ap</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">bp</span></code> はスピンを含まない軌道インデックス <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\alpha^\prime\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, <span class="math notranslate nohighlight">\(\beta^\prime\)</span> に対応します。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">reduced</span></code> または <code class="docutils literal notranslate"><span class="pre">squashed</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(l,q,a,b)</span></code> です。インデックスの意味は上記と同じです。</p></li>
</ul>
</li>
<li><p>スピン対角 (spin-diagonal):</p>
<p><code class="docutils literal notranslate"><span class="pre">enable_spin_orbital</span></code> パラメータが <code class="docutils literal notranslate"><span class="pre">false</span></code> で外場がある場合、もしくは <code class="docutils literal notranslate"><span class="pre">enable_spin_orbital</span></code> パラメータが <code class="docutils literal notranslate"><span class="pre">true</span></code> で <span class="math notranslate nohighlight">\(T_{\tilde\alpha\tilde\beta}(k)\)</span> がスピンについて対角な場合に、既約感受率行列の spin up/down 成分を出力します。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">general</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(s,l,q,a,ap,b,bp)</span></code> となります。 <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">0</span> <span class="pre">(1)</span></code> はそれぞれ spin up (down) 成分を表し、それ以外のインデックスは上記と同じです。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">reduced</span></code> または <code class="docutils literal notranslate"><span class="pre">squashed</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(s,l,q,a,b)</span></code> となります。</p></li>
</ul>
</li>
<li><p>スピン依存 (spinful):</p>
<p><code class="docutils literal notranslate"><span class="pre">enable_spin_orbital</span></code> パラメータが <code class="docutils literal notranslate"><span class="pre">true</span></code> で Transfer項が一般的な形の場合、一般化軌道をインデックスとする既約感受率行列を出力します。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">general</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(l,q,a,ap,b,bp)</span></code> となります。 <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">ap</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">bp</span></code> はスピンを含む一般化軌道インデックス <span class="math notranslate nohighlight">\(\tilde\alpha\)</span>, <span class="math notranslate nohighlight">\(\tilde\alpha^\prime\)</span>, <span class="math notranslate nohighlight">\(\tilde\beta\)</span>, <span class="math notranslate nohighlight">\(\tilde\beta^\prime\)</span> に対応します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">reduced</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(l,q,a,b)</span></code> となります。 <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> はスピンを含む一般化軌道インデックス <span class="math notranslate nohighlight">\(\tilde\alpha\)</span>, <span class="math notranslate nohighlight">\(\tilde\beta\)</span> に対応します。</p></li>
</ul>
</li>
</ul>
</section>
<section id="chiq">
<h1>chiq のデータ形式<a class="headerlink" href="#chiq" title="この見出しへのパーマリンク">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">chiq</span></code> のデータ形式は <code class="docutils literal notranslate"><span class="pre">calc_scheme</span></code> パラメータの値によって以下の形をとります。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">general</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(l,q,a,ap,b,bp)</span></code> となります。 <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">ap</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">bp</span></code> はスピンを含む一般化軌道インデックス <span class="math notranslate nohighlight">\(\tilde\alpha\)</span>, <span class="math notranslate nohighlight">\(\tilde\alpha^\prime\)</span>, <span class="math notranslate nohighlight">\(\tilde\beta\)</span>, <span class="math notranslate nohighlight">\(\tilde\beta^\prime\)</span> に対応します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">reduced</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(l,q,a,b)</span></code> となります。 <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> はスピンを含む一般化軌道インデックス <span class="math notranslate nohighlight">\(\tilde\alpha\)</span>, <span class="math notranslate nohighlight">\(\tilde\beta\)</span> に対応します。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calc_scheme</span> <span class="pre">=</span> <span class="pre">squashed</span></code> の場合、データ配列は <code class="docutils literal notranslate"><span class="pre">ndarray(l,q,s1,s2,a,s3,s4,b)</span></code> となります。 <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> は軌道インデックス <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> に対応し、 <code class="docutils literal notranslate"><span class="pre">s1</span></code> 〜 <code class="docutils literal notranslate"><span class="pre">s4</span></code> はスピンインデックス <span class="math notranslate nohighlight">\(\sigma\)</span>, <span class="math notranslate nohighlight">\(\sigma^\prime\)</span>, <span class="math notranslate nohighlight">\(\sigma_1\)</span>, <span class="math notranslate nohighlight">\(\sigma_1^\prime\)</span> にそれぞれ対応します。</p></li>
</ul>
</section>
<section id="id1">
<h1>データ読み込みの例<a class="headerlink" href="#id1" title="この見出しへのパーマリンク">¶</a></h1>
<p>以下にデータの読み込み方の例を示します。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;output/chiq.npz&#39;</span><span class="p">)</span>

<span class="n">chiq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;chiq&#39;</span><span class="p">]</span>
<span class="n">freq_index</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;freq_index&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/Hwave_logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>ナビゲーション</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about/index.html">1. H-waveとは？</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../howtouse/ho-index.html">2. 基本的な使用方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../uhfr/uhfr-index.html">3. 実空間UHF(UHFr)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../uhfk/uhfk-index.html">4. 波数空間UHF(UHFk)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../rpa-index.html">5. 乱雑位相近似 (RPA)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/tu-index.html">5.1. チュートリアル</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../fi-index.html">5.2. ファイルフォーマット</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../config/index_config.html">5.2.1. 環境設定ファイル</a></li>
<li class="toctree-l3"><a class="reference internal" href="../inputfiles/index_inputfiles.html">5.2.2. RPA用入力ファイル</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index_outputfiles.html">5.2.3. RPAの出力ファイル</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../algorithm/al-index.html">6. アルゴリズム</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../acknowledgement.html">7. 謝辞</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendix/app-index.html">8. Appendix</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../rpa-index.html"><span class="section-number">5. </span>乱雑位相近似 (RPA)</a><ul>
  <li><a href="../fi-index.html"><span class="section-number">5.2. </span>ファイルフォーマット</a><ul>
  <li><a href="index_outputfiles.html"><span class="section-number">5.2.3. </span>RPAの出力ファイル</a><ul>
      <li>Previous: <a href="index_outputfiles.html" title="前の章へ"><span class="section-number">5.2.3. </span>RPAの出力ファイル</a></li>
      <li>Next: <a href="../../../algorithm/al-index.html" title="次の章へ"><span class="section-number">6. </span>アルゴリズム</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022-, The University of Tokyo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../../_sources/rpa/filespecification/outputfiles/chiq_rpa.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>